<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Jul 16, 2013 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title></title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20130716" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                VersionOne.SDK.Java.APIClient
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2013-07-16</span>
                  &nbsp;| <span id="projectVersion">Version: 13.0.1</span>
                      </div>
            <div class="xright">        
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
                          <a href="introduction.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="information_model.html" title="Information Model">Information Model</a>
            </li>
                  <li class="none">
                          <a href="setup.html" title="Setup">Setup</a>
            </li>
                  <li class="none">
                          <a href="queries.html" title="Queries">Queries</a>
            </li>
                  <li class="none">
                          <a href="updates.html" title="Updates">Updates</a>
            </li>
                  <li class="none">
                          <a href="new_asset.html" title="New Asset">New Asset</a>
            </li>
                  <li class="none">
            <strong>Operations</strong>
          </li>
          </ul>
                       <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                        <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Learn By Example: Operations<a name="Learn_By_Example:_Operations"></a></h2><p>An operation is an action that is executed against a single asset. For example, to delete an asset you must execute the Delete operation on the asset. To close or inactivate a Workitem, you must use the Inactivate Operation. Available operations for each asset are listed at the bottom of the the meta data description for that asset, for instance:</p>
<div class="source"><pre>&amp;lt;Server Base URI&amp;gt;/meta.v1/Story?xsl=api.xsl
</pre></div><div class="section"><h3>How to delete a Story asset<a name="How_to_delete_a_Story_asset"></a></h3><p>Get the Delete operation from the IMetaModel, and use IServices to execute it against a story Oid.</p>
<div class="source"><pre>public Oid DeleteAsset() throws Exception
{
    Asset story = AddNewAsset();
    IOperation deleteOperation = metaModel.getOperation(&quot;Story.Delete&quot;);
    Oid deletedID = services.executeOperation(deleteOperation, story.getOid());
    Query query = new Query(deletedID.getMomentless());
    try {
		QueryResult result = services.retrieve(query);
    }
    catch(ConnectionException e) {
        if(404 == e.getServerResponseCode())
			System.out.println(&quot;Story has been deleted: &quot; + story.getOid().getMomentless());        	
    }

    /***** OUTPUT *****
    Story has been deleted: Story:1049
    ******************/

	return deletedID;

}
</pre></div><p>The delete operation returns the Oid, with the new Moment, of the deleted asset. Future current info queries will automatically exclude deleted assets from results.</p><p>Currently, there is no support for undeleting a deleted asset.</p></div><div class="section"><h3>How to close a Story asset<a name="How_to_close_a_Story_asset"></a></h3><p>Get the Inactivate operation from the IMetaModel, and use IServices to execute it against a story Oid.</p>
<div class="source"><pre>public Asset CloseAsset() throws Exception
{ 
    Asset story = AddNewAsset();
    IOperation closeOperation = metaModel.getOperation(&quot;Story.Inactivate&quot;);
    Oid closeID = services.executeOperation(closeOperation, story.getOid());

    Query query = new Query(closeID.getMomentless());
    IAttributeDefinition assetState = metaModel.getAttributeDefinition(&quot;Story.AssetState&quot;);
    query.getSelection().add(assetState);
    QueryResult result = services.retrieve(query);
    Asset closeStory = result.getAssets()[0];
    AssetState state = AssetState.valueOf(((Integer)closeStory.getAttribute(assetState).getValue()).intValue());
    
    System.out.println(closeStory.getOid());
    System.out.println(state.toString());
    /***** OUTPUT *****
     Story:1050
     Closed
    ******************/

    return closeStory;
}
</pre></div><p>The AssetState attribute is the internal state of an asset.</p></div><div class="section"><h3>How to reopen a Story asset<a name="How_to_reopen_a_Story_asset"></a></h3><p>Get the Reactivate operation from the IMetaModel, and use IServices to execute it against a story Oid.</p>
<div class="source"><pre>public Asset ReOpenAsset() throws Exception
{
    Asset story = CloseAsset();
    IOperation activateOperation = metaModel.getOperation(&quot;Story.Reactivate&quot;);
    Oid activeID = services.executeOperation(activateOperation, story.getOid());

    Query query = new Query(activeID.getMomentless());
    IAttributeDefinition assetState = metaModel.getAttributeDefinition(&quot;Story.AssetState&quot;);
    query.getSelection().add(assetState);
    QueryResult result = services.retrieve(query);
    Asset activeStory = result.getAssets()[0];

	AssetState state = AssetState.valueOf(((Integer)activeStory.getAttribute(assetState).getValue()).intValue());

    System.out.println(activeStory.getOid());
    /***** OUTPUT *****
     Story:1051
     Active
    ******************/

    return activeStory;
}
</pre></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2013
                        <a href="http://www.versionone.com/">Version One, Inc.</a>.
            All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
